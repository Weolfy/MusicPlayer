import{d as f,u as b,a as D,C as T,l as x,m as B,O as F,o as n,c as r,F as h,f as m,e as a,t as i,g as A,s as g,P as E,k as N,b as P,p as U,j as $}from"./index.68ce3c5c.js";import{i as L}from"./getDetail.ee9919f8.js";import{g as y}from"./play.0be1cf54.js";import{_ as S}from"./plugin-vue_export-helper.21dcd24c.js";import"./request.6f08c656.js";const V={class:"recentTable"},O=E('<li class="tableItems" id="header" data-v-79e3017a><div class="index" data-v-79e3017a></div><div class="type" data-v-79e3017a> \u7C7B\u522B </div><div class="title" data-v-79e3017a> \u97F3\u4E50\u6807\u9898 </div><div class="artists" data-v-79e3017a> \u6B4C\u624B </div><div class="playTime" data-v-79e3017a> \u64AD\u653E\u65F6\u95F4 </div></li>',1),J=["onDblclick"],M={class:"index"},j={class:"type"},q={class:"title"},z=["onClick"],G={key:0},H=["title"],K={key:0},Q=["title"],W={class:"playTime"},X=f({setup(c){const d=b(),o=D();let u=T(()=>o.getters.getRecent);const v=e=>{d.push("/detail/artist/"+e)};let _=x(0);B(()=>{w(),_.value=+new Date}),F(()=>{_.value=+new Date});const k=e=>new Date(e).getMinutes()+"\u5206\u949F",R=async e=>{const s=await L(e);return await y(s.program.mainSong.id)},C=e=>{e.type=="\u6B4C\u66F2"?(y(e.id).then(s=>{o.commit("setCurrentUrl",s.data[0].url)}),o.commit("pushRecent",{id:e.id,title:e.title,artist:e.artist,type:e.type,time:+new Date})):(R(e.id).then(s=>{let t=s.data[0].url;o.commit("setCurrentUrl",t)}),o.commit("pushRecent",{id:e.id,title:e.title,artist:"/",type:e.type,time:+new Date}))},w=()=>{window.addEventListener("beforeunload",()=>{sessionStorage.setItem("recentPlay",JSON.stringify(u.value))});let e=sessionStorage.getItem("recentPlay");if(e){let s=JSON.parse(e);s.length>0&&(o.state.recent=s)}};return(e,s)=>(n(),r("ul",V,[O,(n(!0),r(h,null,m(g(u),(t,p)=>(n(),r("li",{class:"tableItems",key:t.id,onDblclick:l=>C(t)},[a("div",M,i(p<10?"0"+(p+1):p+1),1),a("div",j,[a("span",null,i(t.type),1)]),a("div",q,i(t.title),1),a("div",{class:"artists",onClick:l=>v(t.artist.id)},[t.artist.length>1?(n(),r("div",G,[(n(!0),r(h,null,m(t.artist,(l,I)=>(n(),r("span",{key:l.id},[a("span",{class:"artist",title:l.name},i(l.name),9,H),I+1!==t.artist.length?(n(),r("span",K," \xA0/\xA0 ")):A("",!0)]))),128))])):(n(),r("span",{key:1,class:"artist",title:t.artist[0].name},i(t.artist[0].name),9,Q))],8,z),a("div",W,i(k(g(_)-t.time))+"\u524D ",1)],40,J))),128))]))}});var Y=S(X,[["__scopeId","data-v-79e3017a"]]);const Z=c=>(U("data-v-7b64be8a"),c=c(),$(),c),ee={class:"recentLayout"},te=Z(()=>a("div",{class:"title"}," \u6700\u8FD1\u64AD\u653E ",-1)),se={class:"recentTable"},ae=f({setup(c){N(),b();const d=D(),o=()=>{d.state.recent.length=0};return(u,v)=>(n(),r("div",ee,[te,a("div",{class:"clearRecent",onClick:o}," \u6E05\u7A7A "),a("div",se,[P(Y)])]))}});var le=S(ae,[["__scopeId","data-v-7b64be8a"]]);export{le as default};
