import{d as R,k as I,u as te,a as P,B as x,n as B,C as b,l as y,r as C,L as se,o as r,c as d,e as n,q as M,A as q,w as m,b as c,t as h,s as g,g as le,i as oe,z as ae,x as ue,F as ne,M as S,m as ie}from"./index.3e4959b4.js";import{s as L}from"./search.fc5bb9cc.js";import{g as A}from"./play.0be1cf54.js";import{_ as T}from"./plugin-vue_export-helper.21dcd24c.js";import"./request.6f08c656.js";const re={class:"table"},ce={style:{display:"flex","align-items":"center","justify-content":"space-between"}},de={class:"num"},me=["onClick"],ge=["onClick"],_e=["title"],pe={key:0,class:"noCopyright"},he={key:1},fe={key:2,class:"trialTags"},ve={key:3,class:"trialTags"},Ce=["title","onClick"],ye=["title","onClick"],we={class:"rClickMenu"},Fe={class:"pagi"},ke=R({props:["loading"],setup(D){const _=I(),f=te(),o=P();let a=x([]);const v=x([]);B(()=>o.state.searchStatus,()=>{if(o.getters.getSongCount==0){v.length=0,S({message:'\u62B1\u6B49\uFF0C\u672A\u80FD\u627E\u5230 "'+_.params.keywords+'" \u76F8\u5173\u641C\u7D22\u7ED3\u679C',offset:250,duration:3e3,customClass:"cpMessage"});let e=document.querySelectorAll(".cpMessage.el-message");if(e)for(let s=0;s<e.length;s++)e[s].style.cssText=" --el-message-bg-color: #000; --el-message-border-color: #000; --el-message-text-color: #ec4141;";return}a=o.getters.getSongResult,v.length=0;for(let e=0;e<a.length;e++)v.push({loved:!1,title:a[e].name,artist:a[e].ar,album:a[e].al,duration:a[e].dt,hot:a[e].pop,id:a[e].id,num:e+1,mvid:a[e].mv,fee:a[e].fee,copyright:a[e].privilege.cp})});const N=e=>{let s=new Date(e),l=s.getMinutes();l=l<10?"0"+l:l;let u=s.getSeconds();return u=u<10?"0"+u:u,l+":"+u},E=e=>{if(e.copyright==0){S({message:"\u8BE5\u6B4C\u66F2\u56E0\u7248\u6743\u6216\u4F1A\u5458\u539F\u56E0\uFF0C\u6682\u65F6\u65E0\u6CD5\u64AD\u653E\uFF0C\u656C\u8BF7\u8C05\u89E3",offset:250,duration:2e3,customClass:"cpMessage"});let s=document.querySelectorAll(".cpMessage.el-message");if(s)for(let l=0;l<s.length;l++)s[l].style.cssText=" --el-message-bg-color: #000; --el-message-border-color: #000; --el-message-text-color: #ec4141;";return}A(e.id).then(s=>{let l=s.data[0].url;o.commit("setCurrentUrl",l),o.commit("pushRecent",{id:e.id,title:e.title,artist:e.artist,type:"\u6B4C\u66F2",time:+new Date,url:l}),o.commit("pushCurrentPlaylist",{id:e.id,title:e.title,artist:e.artist,from:"\u641C\u7D22",duration:e.duration,url:l}),o.commit("setCurrentSongId",e.id)})},V=b(()=>o.getters.getSongCount);let p=y(1);B(()=>p.value,()=>{L(_.params.keywords,(p.value-1)*50).then(e=>{o.commit("setSongResult",e.result.songs),o.commit("changeStatus")})});const $=e=>{f.push("/detail/artist/"+e)},U=e=>{f.push("/detail/album/"+e)},z=e=>{f.push("/detail/song/"+e)},j=e=>{if(e.copyright==0)return;let s={id:e.id,title:e.title,artist:e.artist,album:e.album,duration:e.duration};o.commit("pushFav",s)},O=e=>{o.commit("removeFav",e)};let X=b(()=>o.getters.getFav);const Y=b(()=>function(e){return X.value.some(l=>l.id==e)});let w=y(!1),i=y();const G=(e,s,l)=>{H(),l.preventDefault();let u=document.querySelector(".rClickMenu");u.style.top=(e.num-1)*31+l.offsetY+23+"px",u.style.left=l.offsetX+74+"px",i.value=e},H=()=>{w.value=!0},F=()=>{w.value=!1},J=(e,s,l)=>{let u=document.querySelector(".rClickMenu");l.path.includes(u)||F()},K=()=>{F(),E(i.value)},Q=()=>{if(F(),i.value.copyright==0){S({message:"\u8BE5\u6B4C\u66F2\u56E0\u7248\u6743\u6216\u4F1A\u5458\u539F\u56E0\uFF0C\u6682\u65F6\u65E0\u6CD5\u64AD\u653E\uFF0C\u656C\u8BF7\u8C05\u89E3",offset:250,duration:2e3,customClass:"cpMessage"});let e=document.querySelectorAll(".cpMessage.el-message");if(e)for(let s=0;s<e.length;s++)e[s].style.cssText=" --el-message-bg-color: #000; --el-message-border-color: #000; --el-message-text-color: #ec4141;";return}A(i.value.id).then(e=>{let s=e.data[0].url;o.commit("pushCurrentPlaylist",{id:i.value.id,title:i.value.title,artist:i.value.artist,from:"\u641C\u7D22",duration:i.value.duration,url:s})})};return(e,s)=>{const l=C("el-table-column"),u=C("el-progress"),W=C("el-table"),Z=C("el-pagination"),ee=se("loading");return r(),d(ne,null,[n("div",re,[M((r(),q(W,{data:g(v),style:{width:"100%"},"header-row-class-name":"tableheader",onRowDblclick:E,onRowContextmenu:G,onRowClick:J},{default:m(()=>[c(l,{label:"",width:"60",class:"icon"},{default:m(t=>[n("div",ce,[n("span",de,h(t.row.num<10?"0"+t.row.num:t.row.num),1),g(Y)(t.row.id)?(r(),d("i",{key:1,id:"loveIcon",class:"iconfont icon-aixin",title:"\u53D6\u6D88\u559C\u6B22",onClick:k=>O(t.row.id)},null,8,ge)):(r(),d("i",{key:0,id:"loveIcon",class:"iconfont icon-aixin1-copy",title:"\u559C\u6B22",onClick:k=>j(t.row)},null,8,me))])]),_:1}),c(l,{label:"\u97F3\u4E50\u6807\u9898",width:"230",class:"title"},{default:m(t=>[n("div",{title:t.row.title},[t.row.copyright===0?(r(),d("div",pe,h(t.row.title),1)):(r(),d("div",he,h(t.row.title),1)),t.row.fee==1&&t.row.copyright!=0?(r(),d("span",fe,"\u8BD5\u542C")):t.row.fee==1&&t.row.copyright==0?(r(),d("span",ve,"VIP")):le("",!0)],8,_e)]),_:1}),c(l,{label:"\u6B4C\u624B",width:"100","class-name":"artist"},{default:m(t=>[n("div",{title:t.row.artist[0].name,onClick:k=>$(t.row.artist[0].id)},h(t.row.artist[0].name),9,Ce)]),_:1}),c(l,{label:"\u4E13\u8F91",width:"140","class-name":"album"},{default:m(t=>[n("div",{title:t.row.album.name,onClick:k=>U(t.row.album.id)},h(t.row.album.name),9,ye)]),_:1}),c(l,{label:"\u65F6\u957F",width:"60",class:"duration"},{default:m(t=>[oe(h(N(t.row.duration)),1)]),_:1}),c(l,{label:"\u70ED\u5EA6",class:"hot"},{default:m(t=>[c(u,{percentage:t.row.hot,"show-text":!1,color:"#c8c8c8"},null,8,["percentage"])]),_:1})]),_:1},8,["data"])),[[ee,D.loading]]),M(n("div",we,[n("ul",null,[n("li",{class:"menuItem",onClick:s[0]||(s[0]=t=>z(g(i).id))},"\u67E5\u770B\u8BE6\u60C5"),n("li",{class:"menuItem",onClick:K},"\u64AD\u653E"),n("li",{class:"menuItem",onClick:Q},"\u4E0B\u4E00\u9996\u64AD\u653E")])],512),[[ae,g(w)]])]),n("div",Fe,[c(Z,{background:"",layout:"prev, pager, next","page-size":50,currentPage:g(p),"onUpdate:currentPage":s[1]||(s[1]=t=>ue(p)?p.value=t:p=t),total:g(V)},null,8,["currentPage","total"])])],64)}}});var be=T(ke,[["__scopeId","data-v-edeac146"]]);const Se=R({setup(D){const _=P(),f=I();let o=y(!1);return ie(()=>{L(f.params.keywords).then(a=>{o.value=!0,_.commit("setSongResult",a.result.songs),_.commit("setSongCount",a.result.songCount),_.commit("changeStatus"),o.value=!1})}),(a,v)=>(r(),q(be,{loading:g(o)},null,8,["loading"]))}});var Ae=T(Se,[["__scopeId","data-v-4013f0cc"]]);export{Ae as default};
